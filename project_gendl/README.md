Generating Data for gendl
=========================

Exon-intron-exon
----------------

The main data source is an exon-intron-exon file with the following
space-delimited line structure:

+ 50 nt of exon preceding an intron
+ The entire sequence of the intron (40-150 bp)
+ 50 nt of exon after the intron
+ RNA splice count
+ Source gene

If either exon is below 50, the exon-intron-exon is not reported. If the intron
is short (<40) or long-ish (>150) the exon-intron-exon is not reported.

Duplicate exon-intron-exons from alternative isoforms or closely related genes
are reported only once. In such a case, only one source gene name is given.

Building exon-intron-exon files for 3 genomes.

```
./gendl_build ../genome_athaliana/build/genes > eie.at.txt
./gendl_build ../genome_celegans/build/genes > eie.ce.txt
./gendl_build ../genome_dmelanogaster/build/genes > eie.dm.txt
gzip *.txt
```

The number of exon-intron-exon lines:

+ 62804 A. thaliana
+ 53515 C. elegans
+ 19886 D. melanogaster


### splice42.py

This creates the 42 bp splice site set for 3 genomes. The old method was in the
`lyman-2020` repo, but that is sort of deprecated.

```
mkdir splice42
python3 splice42.py
```

When done, `gzip` and the files and move `splice42` to the `genDL/data`
directory.

+ `at.acc.fa.gz` contains A. thaliana acceptors
+ `at.n1acc.fa.gz` contains negative 1 acceptors
+ `at.n2acc.fa.gz` contains negative 2 acceptors
+ `at.n3acc.fa.gz` is of course negative 3 acceptors

The negative 1 model is just random ACGT.

The negative 2 model is compositional. Each side of the splice site is
randomized. Exons will look a little like exons and intons will look a little
like introns. Positional information (e.g. near donor/acceptor) is not
retained.

The negative 3 model is positional. That is, each position of the sequence is
generated by the average probability at that position. You can think of this as
a giant PWM.


ime50.py
--------

This creates 50 nt segments of intron, coming either from proximal or distal
introns. The first 5 nt (donor) are skipped, as are the last 10 (acceptor).

+ proximal
	+ introns starting before 400
	+ first two 100 nt segments, no partial segments
+ distal
	+ introns starting after 2000
	+ first two 100 nt segments, no partial segments

```
mkdir ime50
python3 ime50.py
```

When done, `gzip` and the files and move `ime50` to the `genDL/data` directory.


rloop100.py
-----------

Use `extract_rloops.py` to create sequences.